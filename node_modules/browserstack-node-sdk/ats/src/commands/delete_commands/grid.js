const a11_0x27e928=a11_0x12ee;function a11_0x12ee(_0x2f9325,_0x42f1af){const _0x310ae8=a11_0x310a();return a11_0x12ee=function(_0x12ee73,_0x3d6c10){_0x12ee73=_0x12ee73-0x15c;let _0x507d09=_0x310ae8[_0x12ee73];return _0x507d09;},a11_0x12ee(_0x2f9325,_0x42f1af);}(function(_0x313126,_0x4b194b){const _0x259fc1=a11_0x12ee,_0x39dc26=_0x313126();while(!![]){try{const _0x2abc95=-parseInt(_0x259fc1(0x1bb))/0x1*(parseInt(_0x259fc1(0x1de))/0x2)+parseInt(_0x259fc1(0x180))/0x3*(-parseInt(_0x259fc1(0x17b))/0x4)+parseInt(_0x259fc1(0x186))/0x5*(parseInt(_0x259fc1(0x163))/0x6)+parseInt(_0x259fc1(0x179))/0x7+-parseInt(_0x259fc1(0x1d1))/0x8*(parseInt(_0x259fc1(0x1c4))/0x9)+parseInt(_0x259fc1(0x195))/0xa*(-parseInt(_0x259fc1(0x187))/0xb)+parseInt(_0x259fc1(0x1c0))/0xc;if(_0x2abc95===_0x4b194b)break;else _0x39dc26['push'](_0x39dc26['shift']());}catch(_0x214e85){_0x39dc26['push'](_0x39dc26['shift']());}}}(a11_0x310a,0x38df9));const fs=require('fs'),got=require(a11_0x27e928(0x1af)),{v4:uuidv4}=require('uuid'),{HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,global_registry,messageTypes,AG_API_URL,AWS,AZURE}=require('../../config/constants'),{logger}=require(a11_0x27e928(0x1a9)),{getCloudProviderObject}=require('../../cloudproviders/utils'),{removeGridComponents,deleteClusterAndDependencies}=require(a11_0x27e928(0x183)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),{inputConfirmation,inputCloudProviderKeys}=require(a11_0x27e928(0x19c)),{createK8sClient}=require(a11_0x27e928(0x1cd)),{kebabCase,getCredentialsPath,getGridDetails,getAuthHeader}=require(a11_0x27e928(0x16f));function a11_0x310a(){const _0x27fae8=['Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','lXqpP','iAvKu','deleteCluster','usage','onlyGridInCluster','LuNrr','../../utils/utilityMethods','debug','uOREk','\x20is\x20not\x20created\x20by\x20Browserstack.\x20Skipping\x20deletion\x20of\x20this\x20cluster','string','builder','Mqqmq','requestId','HYjeu','\x20along\x20with\x20Kubernetes\x20Cluster\x20with\x20name\x20\x22','538174JXOQqM','sCFvx','1652nXOrmM','sUTkK','invalid-grid-id','bBBVC','heUfe','2442ljCBrB','Cluster:\x20','eQxng','../../utils/gridComponents','dIoZj','parse','159835EQntiG','11LCriIj','cloudProvider','clusterId','description','Saving\x20credentials\x20for\x20cloud\x20provider\x20locally\x20for\x20later\x20runs','unknown-error','gridId','vKXDT','unauthorised','ERROR','BSkbC','jXnpF','ujxrg','clusterRegion','1532050GHKYTd','ISavU','toLowerCase','FSWhK','Brswm','options','LBrtK','../../utils/userInput','body','sQTpd','readFileSync','Pass\x20the\x20ID\x20of\x20the\x20Grid','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','Xpjto','RKhTC','stringify','OQLSL','PpINt','ycWMj','Grid\x20ID\x20not\x20passed.\x20Please\x20provide\x20a\x20Grid\x20ID\x20to\x20delete\x20using\x20--grid-id\x20option','../../config/logger','This\x20will\x20delete\x20the\x20Grid\x20with\x20name\x20\x22','command','type','XIXNG','paKCV','got','OWdQh','epilogue','warn','Grid\x20is\x20deleted\x20but\x20failed\x20to\x20update\x20server\x20for\x20grid\x20deletion.\x20Response\x20from\x20server:\x20','clusterName','FzDcL','grid-id','Found\x20credentials\x20for\x20cloud\x20provider\x20locally.\x20Using\x20them\x20for\x20performing\x20actions','aPmxr','NkdJr','Mvarp','4qnrFeU','server-error','SZJFf','jAEZW','password','9796092yrkGjj','eldNt','CgfcW','Browserstack','369tByGRR','username','okiZc','Wkofh','error','INFO','fJOmS','exit','\x22\x20with\x20ID\x20','../../utils/createk8sClient','stack','info','DELETE','10640ENOvFa','name','ATPEn','QAVeL','PzeWF','desc','existsSync','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','FTQNt','.\x20Do\x20you\x20want\x20to\x20proceed\x20with\x20deletion?\x20(y/n)','yhzHM','MrsWS','/packages/cli/grid/','138094KkIWVu','zLxEc','oJfoo','statusCode','Delete\x20an\x20Automation\x20grid.','UeTHa','FvfSp','GDEML','30EpaSnW','KPjpJ','YnusU','help','Succesfully\x20deleted\x20the\x20grid'];a11_0x310a=function(){return _0x27fae8;};return a11_0x310a();}exports[a11_0x27e928(0x1ab)]='grid',exports[a11_0x27e928(0x1d6)]=a11_0x27e928(0x15f),exports[a11_0x27e928(0x174)]=function(_0x24d94d){const _0x29408b=a11_0x27e928,_0x5b0fec={};_0x5b0fec['QAVeL']=_0x29408b(0x1a0),_0x5b0fec[_0x29408b(0x17a)]=_0x29408b(0x173),_0x5b0fec['GDEML']=_0x29408b(0x166);const _0x233b28=_0x5b0fec,_0x4e3157={};_0x4e3157[_0x29408b(0x18a)]=_0x233b28[_0x29408b(0x1d4)],_0x4e3157[_0x29408b(0x1ac)]=_0x233b28[_0x29408b(0x17a)];const _0x3a78f2={};return _0x3a78f2['grid-id']=_0x4e3157,_0x24d94d[_0x29408b(0x16c)](HELP_HEADER_MESSAGE['delete'])[_0x29408b(0x1b1)](HELP_FOOTER_MESSAGE)[_0x29408b(0x19a)](_0x3a78f2)[_0x29408b(0x166)](_0x233b28[_0x29408b(0x162)])['argv'];},exports['handler']=async function(_0xae8ee6){const _0x247708=a11_0x27e928,_0x5f39e8={'bBBVC':_0x247708(0x1a0),'eurpC':'string','SHVyL':_0x247708(0x166),'aPmxr':_0x247708(0x1a8),'eldNt':function(_0x3f48a4){return _0x3f48a4();},'vKXDT':function(_0x30be15){return _0x30be15();},'LBrtK':function(_0x440876,_0x35f3b1){return _0x440876===_0x35f3b1;},'FTQNt':_0x247708(0x192),'ISavU':_0x247708(0x1d8),'OWdQh':function(_0x34ba27,_0x5938c4,_0x1f4952,_0x4dc7c6,_0x2e333f,_0x10db5b,_0x49024a){return _0x34ba27(_0x5938c4,_0x1f4952,_0x4dc7c6,_0x2e333f,_0x10db5b,_0x49024a);},'Wkofh':'delete-grid-called','HYjeu':'init-not-called','BSkbC':function(_0x222ced,_0xee4ec){return _0x222ced===_0xee4ec;},'UeTHa':'fzRxR','FzDcL':_0x247708(0x1a6),'uOREk':function(_0x545f71,_0x436aa8,_0x419a26,_0x3df3c6){return _0x545f71(_0x436aa8,_0x419a26,_0x3df3c6);},'ujxrg':_0x247708(0x1c3),'heUfe':_0x247708(0x16e),'OQLSL':_0x247708(0x1db),'SZJFf':function(_0x52d344,_0x39d562){return _0x52d344(_0x39d562);},'lUYsw':function(_0x31b8f5,_0x36a8b2){return _0x31b8f5===_0x36a8b2;},'iAvKu':function(_0x555f5b,_0x48959a){return _0x555f5b===_0x48959a;},'Brswm':function(_0x46bc35,_0x59b8f9){return _0x46bc35!==_0x59b8f9;},'jAEZW':'MqxRI','ycWMj':'Wrong\x20input!\x20Please\x20try\x20again\x20with\x20a\x20valid\x20input.','NCUtr':'invalid-input','dIoZj':'jsCss','FSWhK':_0x247708(0x1c2),'NkdJr':function(_0x13d337,_0xecaf5){return _0x13d337===_0xecaf5;},'pLIrA':function(_0x361a8c,_0x70e47f){return _0x361a8c!==_0x70e47f;},'lXqpP':_0x247708(0x1d3),'zLCtR':'Unable\x20to\x20fetch\x20credentials\x20for\x20cloud\x20provider\x20locally','sUTkK':_0x247708(0x161),'PzeWF':_0x247708(0x164),'MrsWS':_0x247708(0x18b),'VAbku':_0x247708(0x1b7),'Xpjto':function(_0xca2aef,_0x3802bd){return _0xca2aef(_0x3802bd);},'XIXNG':function(_0x390f14,_0x393b2e,_0x1d7e72,_0x4ca8e4,_0x3a5adb,_0x4f05d4){return _0x390f14(_0x393b2e,_0x1d7e72,_0x4ca8e4,_0x3a5adb,_0x4f05d4);},'eQxng':_0x247708(0x1d0),'fJOmS':function(_0x3fb162,_0x4b3881,_0x2b8bdd){return _0x3fb162(_0x4b3881,_0x2b8bdd);},'Mvarp':function(_0x1f1aa8,_0x5cdb7c){return _0x1f1aa8!==_0x5cdb7c;},'sQTpd':_0x247708(0x1bc),'okiZc':function(_0x1f9260,_0x3e2ad8){return _0x1f9260===_0x3e2ad8;},'RKhTC':_0x247708(0x18f),'Mqqmq':function(_0x50354a,_0x577704,_0x132a70,_0x121fe8,_0x1c1f87,_0x4f20b9,_0x2a4844){return _0x50354a(_0x577704,_0x132a70,_0x121fe8,_0x1c1f87,_0x4f20b9,_0x2a4844);},'zLxEc':_0x247708(0x17d),'YnusU':function(_0x49ba60,_0x4c2947,_0x32f0ef,_0x420594,_0x3a04f1,_0x368224,_0x410119){return _0x49ba60(_0x4c2947,_0x32f0ef,_0x420594,_0x3a04f1,_0x368224,_0x410119);},'oJfoo':function(_0x4367bb,_0x47bbd5,_0x3dc232,_0x8d5304,_0x56220a,_0x5049b2,_0x34ed34){return _0x4367bb(_0x47bbd5,_0x3dc232,_0x8d5304,_0x56220a,_0x5049b2,_0x34ed34);},'paKCV':_0x247708(0x18c)};try{global_registry[_0x247708(0x176)]=_0x5f39e8[_0x247708(0x1c1)](uuidv4);!fs[_0x247708(0x1d7)](_0x5f39e8[_0x247708(0x18e)](getCredentialsPath))&&(_0x5f39e8[_0x247708(0x19b)](_0x5f39e8[_0x247708(0x1d9)],_0x5f39e8[_0x247708(0x1d9)])?(console['error'](_0x5f39e8[_0x247708(0x196)]),await _0x5f39e8[_0x247708(0x1b0)](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8[_0x247708(0x177)],null,_0xae8ee6),process[_0x247708(0x1cb)](0x1)):_0x37a583[_0x247708(0x1b2)]('Cluster:\x20'+_0x154cf5[_0x247708(0x1b4)]+_0x247708(0x172)));_0x5f39e8['OWdQh'](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8['Wkofh'],messageTypes[_0x247708(0x1c9)],null,null,_0xae8ee6);!_0xae8ee6[_0x247708(0x18d)]&&(_0x5f39e8['BSkbC'](_0x5f39e8[_0x247708(0x160)],_0x5f39e8[_0x247708(0x1b5)])?_0x2dc599[_0x247708(0x1cb)](0x0):(console[_0x247708(0x1c8)](_0x5f39e8[_0x247708(0x1b8)]),process[_0x247708(0x1cb)](0x1)));const _0x57c49d=JSON[_0x247708(0x185)](fs[_0x247708(0x19f)](_0x5f39e8['eldNt'](getCredentialsPath))),[_0x27e98b,_0x20179e]=await _0x5f39e8[_0x247708(0x171)](getGridDetails,_0x57c49d[_0x247708(0x1c3)][_0x247708(0x1c5)],_0x57c49d[_0x247708(0x1c3)][_0x247708(0x1bf)],_0xae8ee6['gridId']);if(_0x20179e){const _0x266fa5=_0x20179e[_0x247708(0x1cf)];let _0x9466f1=_0x247708(0x1aa)+_0x266fa5[_0x247708(0x1d2)]+'\x22\x20and\x20ID\x20'+_0x266fa5['id']+_0x247708(0x1da),_0xa755b3;if(_0x20179e[_0x247708(0x16d)]&&_0x5f39e8[_0x247708(0x19b)](_0x20179e['clusterSpawnedVia'],_0x5f39e8[_0x247708(0x193)])){if(_0x5f39e8[_0x247708(0x19b)](_0x5f39e8[_0x247708(0x17f)],_0x5f39e8[_0x247708(0x1a5)])){const _0x34f9cd={};_0x34f9cd[_0x247708(0x18a)]=_0x5f39e8[_0x247708(0x17e)],_0x34f9cd[_0x247708(0x1ac)]=_0x5f39e8['eurpC'];const _0x43bc0e={};return _0x43bc0e[_0x247708(0x1b6)]=_0x34f9cd,_0x3b34db[_0x247708(0x16c)](_0x11b2ab['delete'])[_0x247708(0x1b1)](_0xc7ba79)[_0x247708(0x19a)](_0x43bc0e)[_0x247708(0x166)](_0x5f39e8['SHVyL'])['argv'];}else _0x9466f1=_0x247708(0x1aa)+_0x266fa5['name']+'\x22\x20and\x20ID\x20'+_0x266fa5['id']+_0x247708(0x178)+_0x266fa5[_0x247708(0x1b4)]+_0x247708(0x1cc)+_0x266fa5[_0x247708(0x189)]+_0x247708(0x1da);}_0xa755b3=await _0x5f39e8['SZJFf'](inputConfirmation,_0x9466f1);(_0x5f39e8[_0x247708(0x191)](_0xa755b3,undefined)||_0x5f39e8[_0x247708(0x19b)](_0xa755b3,null)||!(_0x5f39e8['lUYsw'](_0xa755b3[_0x247708(0x197)](),'y')||_0x5f39e8[_0x247708(0x16a)](_0xa755b3['toLowerCase'](),'n')))&&(_0x5f39e8[_0x247708(0x199)](_0x5f39e8['jAEZW'],_0x5f39e8[_0x247708(0x1be)])?(_0x561cc5[_0x247708(0x1cf)](_0x247708(0x167)),_0x41f970[_0x247708(0x1cb)](0x0)):(console[_0x247708(0x1c8)](_0x5f39e8[_0x247708(0x1a7)]),await _0x5f39e8[_0x247708(0x1b0)](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8['NCUtr'],null,_0xae8ee6),process['exit'](0x1)));_0x5f39e8['iAvKu'](_0xa755b3[_0x247708(0x197)](),'n')&&(_0x5f39e8[_0x247708(0x16a)](_0x5f39e8[_0x247708(0x184)],_0x5f39e8[_0x247708(0x198)])?_0x3a575c=_0x247708(0x1aa)+_0x18cc06['name']+'\x22\x20and\x20ID\x20'+_0x54cff1['id']+_0x247708(0x178)+_0x40d256[_0x247708(0x1b4)]+_0x247708(0x1cc)+_0x3cb8b9[_0x247708(0x189)]+_0x247708(0x1da):process[_0x247708(0x1cb)](0x0));global_registry[_0x247708(0x194)]=_0x266fa5['region'];const _0xf5c339=_0x266fa5['cloudProvider'],_0x3e79dd=_0x5f39e8[_0x247708(0x171)](getCloudProviderObject,_0xf5c339,_0x266fa5[_0x247708(0x1b4)],_0x266fa5[_0x247708(0x1d2)]),_0x605d40=_0x57c49d[_0x247708(0x188)];if(_0x5f39e8[_0x247708(0x1b9)](_0x605d40[_0xf5c339],undefined)){if(_0x5f39e8['pLIrA'](_0x5f39e8[_0x247708(0x169)],_0x5f39e8[_0x247708(0x169)]))_0x588251[_0x247708(0x188)]={};else{logger['info'](_0x5f39e8['zLCtR']);_0x5f39e8[_0x247708(0x19b)](_0x57c49d['cloudProvider'],undefined)&&(_0x5f39e8[_0x247708(0x199)](_0x5f39e8[_0x247708(0x17c)],_0x5f39e8[_0x247708(0x1d5)])?_0x57c49d['cloudProvider']={}:(_0x3447e9[_0x247708(0x1c8)](_0x5f39e8[_0x247708(0x1b8)]),_0x100c9a[_0x247708(0x1cb)](0x1)));_0x57c49d[_0x247708(0x188)][_0xf5c339]={};const _0x3c935c=await _0x5f39e8['uOREk'](inputCloudProviderKeys,_0xf5c339,_0x57c49d,_0x3e79dd);fs['writeFileSync'](_0x5f39e8['eldNt'](getCredentialsPath),JSON[_0x247708(0x1a4)](_0x3c935c)),logger[_0x247708(0x170)](_0x5f39e8[_0x247708(0x1dc)]);}}else logger[_0x247708(0x1cf)](_0x5f39e8['VAbku']),await _0x3e79dd['fetchLocalCreds'](_0x605d40);_0x3e79dd['configureIfNotConfigured']();const _0x1c3c90=_0x5f39e8[_0x247708(0x1bd)](kebabCase,_0x266fa5['name']),[_0xb65029,_0x3690eb,_0x337499,_0x32d300,_0x46345c,_0x41845d]=await _0x5f39e8[_0x247708(0x1a2)](createK8sClient,_0x3e79dd);await _0x5f39e8[_0x247708(0x1ad)](removeGridComponents,_0xb65029,_0x3690eb,_0x337499,_0x32d300,_0x1c3c90);if(_0x20179e[_0x247708(0x16d)]){const _0x46d28f=await _0x3e79dd['isBrowserstackCluster']();_0x46d28f?await _0x3e79dd[_0x247708(0x16b)](_0xb65029,_0x266fa5['region']):logger['warn'](_0x247708(0x181)+_0x266fa5[_0x247708(0x1b4)]+_0x247708(0x172));}const _0x5f306a='https://'+AG_API_URL+_0x247708(0x1dd)+_0xae8ee6[_0x247708(0x18d)],_0x1605e5={'method':_0x5f39e8[_0x247708(0x182)],'headers':_0x5f39e8[_0x247708(0x1ca)](getAuthHeader,_0x57c49d[_0x247708(0x1c3)][_0x247708(0x1c5)],_0x57c49d[_0x247708(0x1c3)][_0x247708(0x1bf)])},_0x1b8cfc=await _0x5f39e8['fJOmS'](got,_0x5f306a,_0x1605e5);_0x5f39e8['Brswm'](_0x1b8cfc,null)&&_0x5f39e8[_0x247708(0x1ba)](_0x1b8cfc,undefined)&&_0x5f39e8[_0x247708(0x16a)](_0x1b8cfc[_0x247708(0x15e)],0xc8)&&(logger[_0x247708(0x1cf)](_0x247708(0x167)),process['exit'](0x0)),logger[_0x247708(0x1c8)](_0x247708(0x1b3)+JSON['stringify'](_0x1b8cfc)),await _0x5f39e8['OWdQh'](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8['sQTpd'],_0x27e98b,_0xae8ee6),process['exit'](0x1);}_0x5f39e8[_0x247708(0x1c6)](_0x27e98b[_0x247708(0x15e)],0x191)&&(logger[_0x247708(0x1c8)](_0x247708(0x168)),await _0x5f39e8['OWdQh'](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8[_0x247708(0x1a3)],null,_0xae8ee6),process[_0x247708(0x1cb)](0x1)),_0x5f39e8[_0x247708(0x16a)](_0x27e98b[_0x247708(0x15e)],0x190)&&(logger[_0x247708(0x1c8)](JSON['parse'](_0x27e98b[_0x247708(0x19d)])['message']),await _0x5f39e8[_0x247708(0x175)](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8[_0x247708(0x15c)],null,_0xae8ee6),process[_0x247708(0x1cb)](0x1)),logger[_0x247708(0x1c8)](_0x247708(0x1a1)+JSON['stringify'](_0x27e98b)),await _0x5f39e8[_0x247708(0x165)](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes[_0x247708(0x190)],_0x5f39e8[_0x247708(0x19e)],_0x27e98b,_0xae8ee6),process['exit'](0x1);}catch(_0x3dc41c){logger['error']('Failed\x20to\x20delete\x20resources!\x20Error:\x20'+_0x3dc41c[_0x247708(0x1ce)]),await _0x5f39e8[_0x247708(0x15d)](sendInstrumentationEvent,_0xae8ee6,_0x5f39e8[_0x247708(0x1c7)],messageTypes['ERROR'],_0x5f39e8[_0x247708(0x1ae)],_0x3dc41c,_0xae8ee6),process[_0x247708(0x1cb)](0x1);}};