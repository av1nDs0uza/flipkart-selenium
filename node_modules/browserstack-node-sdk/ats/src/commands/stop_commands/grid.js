const a19_0x3c1874=a19_0x4caa;function a19_0x4caa(_0x1daf25,_0xf42f4d){const _0x1b1455=a19_0x1b14();return a19_0x4caa=function(_0x4caa1f,_0x22b734){_0x4caa1f=_0x4caa1f-0x7d;let _0x1866cc=_0x1b1455[_0x4caa1f];return _0x1866cc;},a19_0x4caa(_0x1daf25,_0xf42f4d);}function a19_0x1b14(){const _0x43b166=['2613372dsxlaB','1149401piJXhP','info','CLEud','clusterName','ewTuz','348494iGYbez','exit','builder','description','SWlzl','1533NyCfKS','MdOkW','290aXBjoV','nvMrj','fZeOR','../../utils/utilityMethods','78UMhsqX','2484530XUwKaC','<PasswordPlaceholder>','fetchLocalCreds','server-error','error','invalid-grid-id','../../utils/instrumentationUtils','tOvwu','3RczjeC','FOmRY','usage','CWZty','DdyXu','ERROR','SZQQv','../../cloudproviders/utils','204093ZsiTeh','reconnecting-websocket','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','WebSocket','BNlnj','BwPIW','name','Adding\x20Websocket\x20listeners','Browserstack','toqXx','type','TcHCq','epilogue','desc','../../config/logger','HCUca','replace','connectionTimeout','parse','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','username','region','handler','statusCode','Stop\x20a\x20running\x20Automation\x20grid.','KlRfE','Stopping\x20grid\x20','6NgKkIU','GRpHm','command','../../utils/gridComponents','../../utils/createk8sClient','stack','MfVFH','Grid\x20stoppped.','cloudProvider','7pQmMeH','string','grid-id','user','readFileSync','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','body','yXQHZ','gridId','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','unauthorised','zgjdM','bstackUsername','stringify','password','<UsernamePlaceholder>','4668592AqESGS','init-not-called','INFO','4436xJGXkk','message','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','help','qClgH'];a19_0x1b14=function(){return _0x43b166;};return a19_0x1b14();}(function(_0x4b702e,_0x5da408){const _0x1b95c4=a19_0x4caa,_0x546578=_0x4b702e();while(!![]){try{const _0x5e2bdd=-parseInt(_0x1b95c4(0xd3))/0x1*(-parseInt(_0x1b95c4(0xbf))/0x2)+-parseInt(_0x1b95c4(0xc4))/0x3*(parseInt(_0x1b95c4(0xb4))/0x4)+parseInt(_0x1b95c4(0xcb))/0x5*(parseInt(_0x1b95c4(0x98))/0x6)+-parseInt(_0x1b95c4(0xa1))/0x7*(parseInt(_0x1b95c4(0xb1))/0x8)+parseInt(_0x1b95c4(0x7d))/0x9*(-parseInt(_0x1b95c4(0xc6))/0xa)+-parseInt(_0x1b95c4(0xba))/0xb+-parseInt(_0x1b95c4(0xb9))/0xc*(-parseInt(_0x1b95c4(0xca))/0xd);if(_0x5e2bdd===_0x5da408)break;else _0x546578['push'](_0x546578['shift']());}catch(_0x248134){_0x546578['push'](_0x546578['shift']());}}}(a19_0x1b14,0x650f0));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a19_0x3c1874(0x7e)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a19_0x3c1874(0x8b)),{getCredentialsPath,getGridDetails}=require(a19_0x3c1874(0xc9)),{scaleDownHubDeployment}=require(a19_0x3c1874(0x9b)),{sendInstrumentationEvent}=require(a19_0x3c1874(0xd1)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a19_0x3c1874(0x9c)),{getCloudProviderObject}=require(a19_0x3c1874(0xda));exports[a19_0x3c1874(0x9a)]='grid',exports[a19_0x3c1874(0x8a)]=a19_0x3c1874(0x95),exports[a19_0x3c1874(0xc1)]=function(_0x5d798f){const _0x548f1f=a19_0x3c1874,_0x1eea56={};_0x1eea56[_0x548f1f(0xd7)]=_0x548f1f(0x90),_0x1eea56[_0x548f1f(0xb8)]=_0x548f1f(0xa2),_0x1eea56[_0x548f1f(0xc7)]=_0x548f1f(0xb7);const _0x5cbfb3=_0x1eea56,_0xde017d={};_0xde017d[_0x548f1f(0xc2)]=_0x5cbfb3[_0x548f1f(0xd7)],_0xde017d[_0x548f1f(0x87)]=_0x5cbfb3[_0x548f1f(0xb8)];const _0x30d5dd={};return _0x30d5dd[_0x548f1f(0xa3)]=_0xde017d,_0x5d798f[_0x548f1f(0xd5)](HELP_HEADER_MESSAGE['stop'])[_0x548f1f(0x89)](HELP_FOOTER_MESSAGE)['options'](_0x30d5dd)['help'](_0x5cbfb3['nvMrj'])['argv'];},exports[a19_0x3c1874(0x93)]=async function(_0x2353c1){const _0x45c294=a19_0x3c1874,_0x545461={'OGOkO':_0x45c294(0xa6),'GRpHm':function(_0x4490d3){return _0x4490d3();},'TcHCq':_0x45c294(0xaa),'ewTuz':function(_0x8518ce,_0x509a9f,_0x385971,_0x20fea6,_0x1bcea2,_0x43f1bb,_0x2b3bd7){return _0x8518ce(_0x509a9f,_0x385971,_0x20fea6,_0x1bcea2,_0x43f1bb,_0x2b3bd7);},'SZQQv':'stop-grid-called','tOvwu':_0x45c294(0xb2),'MdOkW':function(_0x6fe5a8,_0x2c50e4,_0x1810c9,_0x3cd44b,_0x357003,_0x392fbf,_0x2cdcee){return _0x6fe5a8(_0x2c50e4,_0x1810c9,_0x3cd44b,_0x357003,_0x392fbf,_0x2cdcee);},'zgjdM':_0x45c294(0xb0),'BNlnj':_0x45c294(0xcc),'MfVFH':_0x45c294(0x84),'SWlzl':function(_0xecc55a,_0x49347d,_0x1964bc,_0x5a4f79){return _0xecc55a(_0x49347d,_0x1964bc,_0x5a4f79);},'fZeOR':function(_0x3f5b06,_0x2d955e,_0x3e1506,_0x26b934,_0x102eae,_0x48c417){return _0x3f5b06(_0x2d955e,_0x3e1506,_0x26b934,_0x102eae,_0x48c417);},'BwPIW':function(_0x1b7d52,_0x2e8357){return _0x1b7d52(_0x2e8357);},'ZeAEx':function(_0x2fc94f,_0x428194,_0x43c4d6){return _0x2fc94f(_0x428194,_0x43c4d6);},'CWZty':_0x45c294(0x9f),'KlRfE':function(_0x4df9c4,_0x327ce3){return _0x4df9c4===_0x327ce3;},'CLEud':function(_0x28975d,_0x4c529e,_0x53a229,_0x3fd15d,_0xc96213,_0x1511d3,_0x2c9dec){return _0x28975d(_0x4c529e,_0x53a229,_0x3fd15d,_0xc96213,_0x1511d3,_0x2c9dec);},'HCUca':_0x45c294(0xab),'OnnYh':function(_0x446feb,_0x9a0319){return _0x446feb===_0x9a0319;},'toqXx':function(_0x1eb289,_0x5de24e,_0x1c9cb7,_0x1c5e53,_0x29847f,_0x5932db,_0x4599cf){return _0x1eb289(_0x5de24e,_0x1c9cb7,_0x1c5e53,_0x29847f,_0x5932db,_0x4599cf);},'yXQHZ':_0x45c294(0xd0),'FOmRY':_0x45c294(0xce)};let _0xaf26a2;try{!_0x2353c1[_0x45c294(0xa9)]&&(logger['error'](_0x545461['OGOkO']),process[_0x45c294(0xc0)](0x1));!fs['existsSync'](_0x545461[_0x45c294(0x99)](getCredentialsPath))&&(logger['error'](_0x545461[_0x45c294(0x88)]),await _0x545461[_0x45c294(0xbe)](sendInstrumentationEvent,_0x2353c1,_0x545461[_0x45c294(0xd9)],messageTypes['ERROR'],_0x545461[_0x45c294(0xd2)],null,_0x2353c1),process[_0x45c294(0xc0)](0x1));logger[_0x45c294(0xbb)](_0x45c294(0x97)+_0x2353c1[_0x45c294(0xa9)]),await _0x545461[_0x45c294(0xc5)](sendInstrumentationEvent,_0x2353c1,_0x545461[_0x45c294(0xd9)],messageTypes[_0x45c294(0xb3)],null,null,_0x2353c1);const _0x16a974=JSON[_0x45c294(0x8f)](fs[_0x45c294(0xa5)](_0x545461[_0x45c294(0x99)](getCredentialsPath)));global_registry[_0x45c294(0xad)]=_0x16a974[_0x45c294(0x85)][_0x45c294(0x91)],global_registry['bstackAccesskey']=_0x16a974[_0x45c294(0x85)][_0x45c294(0xaf)];const _0x5670ed=WS_ENDPOINT['replace'](_0x545461[_0x45c294(0xac)],_0x16a974[_0x45c294(0x85)][_0x45c294(0x91)])[_0x45c294(0x8d)](_0x545461[_0x45c294(0x81)],_0x16a974[_0x45c294(0x85)]['password']),_0x1b5b7a={};_0x1b5b7a[_0x45c294(0x80)]=ws,_0x1b5b7a[_0x45c294(0x8e)]=0x36ee80,_0xaf26a2=new ReconnectingWebSocket(_0x5670ed,[],_0x1b5b7a),logger['debug'](_0x545461[_0x45c294(0x9e)]),webSocketUtils['addListeners'](_0xaf26a2,_0x2353c1[_0x45c294(0xa4)],_0x2353c1[_0x45c294(0xaf)]);const [_0x1c07f9,_0x501b37]=await _0x545461[_0x45c294(0xc3)](getGridDetails,_0x16a974['Browserstack']['username'],_0x16a974['Browserstack'][_0x45c294(0xaf)],_0x2353c1[_0x45c294(0xa9)]);if(_0x501b37){const _0x527a30=_0x501b37[_0x45c294(0xbb)];global_registry[_0x45c294(0xa0)]=_0x527a30[_0x45c294(0xa0)],global_registry['clusterRegion']=_0x527a30[_0x45c294(0x92)],global_registry[_0x45c294(0xbd)]=_0x527a30[_0x45c294(0xbd)];const _0x43c6dc=_0x545461[_0x45c294(0xc8)](getCloudProviderObject,_0x527a30[_0x45c294(0xa0)],_0x527a30['clusterName'],_0x527a30[_0x45c294(0x83)],_0xaf26a2,webSocketUtils),_0x35fa6=_0x16a974[_0x45c294(0xa0)]||{};await _0x43c6dc[_0x45c294(0xcd)](_0x35fa6),_0x43c6dc['configureIfNotConfigured']();const [_0x43d472,_0x2df64d,_0x46347b,_0x2db29c,_0x3645be,_0x402e02]=await _0x545461[_0x45c294(0x82)](createK8sClient,_0x43c6dc);await _0x545461['ZeAEx'](scaleDownHubDeployment,_0x2df64d,_0x527a30[_0x45c294(0x83)]),logger[_0x45c294(0xbb)](_0x545461[_0x45c294(0xd6)]),process[_0x45c294(0xc0)](0x0);}_0x545461[_0x45c294(0x96)](_0x1c07f9[_0x45c294(0x94)],0x191)&&(logger[_0x45c294(0xcf)](_0x45c294(0xb6)),await _0x545461[_0x45c294(0xbc)](sendInstrumentationEvent,_0x2353c1,_0x545461['SZQQv'],messageTypes[_0x45c294(0xd8)],_0x545461[_0x45c294(0x8c)],null,_0x2353c1),process[_0x45c294(0xc0)](0x1)),_0x545461['OnnYh'](_0x1c07f9[_0x45c294(0x94)],0x190)&&(logger[_0x45c294(0xcf)](JSON['parse'](_0x1c07f9[_0x45c294(0xa7)])[_0x45c294(0xb5)]),await _0x545461[_0x45c294(0x86)](sendInstrumentationEvent,_0x2353c1,_0x545461[_0x45c294(0xd9)],messageTypes[_0x45c294(0xd8)],_0x545461[_0x45c294(0xa8)],null,_0x2353c1),process[_0x45c294(0xc0)](0x1)),logger['error'](_0x45c294(0x7f)+JSON[_0x45c294(0xae)](_0x1c07f9)),await _0x545461[_0x45c294(0xbc)](sendInstrumentationEvent,_0x2353c1,_0x545461['SZQQv'],messageTypes[_0x45c294(0xd8)],_0x545461[_0x45c294(0xd4)],_0x1c07f9,_0x2353c1),process[_0x45c294(0xc0)](0x1);}catch(_0x4a28a4){const _0x4b240a='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x4a28a4+'\x20\x0a'+JSON[_0x45c294(0xae)](_0x4a28a4[_0x45c294(0x9d)])+'\x20';logger[_0x45c294(0xcf)](_0x4b240a),process['exit'](0x1);}};